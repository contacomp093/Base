{% load static %}
{% load i18n %}
<!DOCTYPE html>
<html lang="{{ LANGUAGE_CODE }}" class="h-full transition-colors duration-700">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% trans "Iniciar SesiÃ³n" %}</title>

    <!-- Tailwind compilado -->
    <link rel="stylesheet" href="{% static 'css/output.css' %}" />

    <!-- ðŸŽ¨ Estilos personalizados y colores HEX fijos -->
    <style>
      /******************************
       *  ðŸŽ¨ FONDOS (solo decoraciÃ³n)
       ******************************/
      @keyframes gradientMove {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
      }

      body {
        background: linear-gradient(-45deg, #22c55e, #38bdf8, #3b82f6, #8b5cf6);
        background-size: 300% 300%;
        animation: gradientMove 14s ease infinite;
        color: #1f2937;
        transition: color 0.7s ease-in-out;
      }

      body.dark {
        background: linear-gradient(-45deg, #020617, #0f172a, #1e3a8a, #5b21b6);
        background-size: 300% 300%;
        animation: gradientMove 18s ease infinite;
        color: #f3f4f6;
      }

      /******************************
       *  ðŸ”¥ COLORES CONSISTENTES
       ******************************/

      /* TÃ­tulos */
      h1 { color: #0f172a !important; }
      body.dark h1 { color: #f8fafc !important; }

      /* Texto general */
      p, label { color: #334155 !important; }
      body.dark p, body.dark label { color: #cbd5e1 !important; }

      /* Links */
      a { color: #4f46e5 !important; }
      body.dark a { color: #818cf8 !important; }

      /* Tarjeta translÃºcida */
      .card-translucent {
        background-color: rgba(255,255,255,0.40) !important;
        border: 1px solid rgba(255,255,255,0.30) !important;
        backdrop-filter: blur(20px) !important;
      }
      body.dark .card-translucent {
        background-color: rgba(31,41,55,0.50) !important;
        border-color: rgba(55,65,81,0.40) !important;
      }

      /* Inputs */
      input {
        background-color: rgba(255,255,255,0.70) !important;
        border: 1px solid #d1d5db !important;
        color: #1f2937 !important;
      }
      body.dark input {
        background-color: rgba(55,65,81,0.80) !important;
        border-color: #4b5563 !important;
        color: #f3f4f6 !important;
      }

      /* Focus ring */
      input:focus {
        outline: none !important;
        box-shadow: 0 0 0 3px rgba(129,140,248,0.7) !important;
      }

      /* BotÃ³n de iniciar sesiÃ³n */
      .btn-primary {
        background-color: #4f46e5 !important;
        color: #ffffff !important;
        transition: transform 0.3s, background-color 0.3s;
      }
      .btn-primary:hover {
        background-color: #4338ca !important;
        transform: scale(1.02);
      }

      /* AnimaciÃ³n de entrada */
      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px) scale(0.97); }
        to { opacity: 1; transform: translateY(0) scale(1); }
      }
      .fade-in { animation: fadeIn 0.6s ease-out forwards; }
    </style>
  </head>

  <body class="h-full transition-colors duration-700">
    <div class="flex flex-col items-center justify-center h-screen p-4 fade-in relative">

      <!-- ðŸŒ™ BotÃ³n de cambio de tema -->
      <button
        id="theme-toggle"
        class="absolute top-4 right-4 flex items-center justify-center w-10 h-10 rounded-full border border-gray-400 dark:border-gray-600 bg-white/90 dark:bg-gray-900/80 hover:bg-gray-100 dark:hover:bg-gray-800 shadow-2xl backdrop-blur-md transition-all duration-500 transform hover:scale-110"
        aria-label="{% trans 'Cambiar tema' %}"
      >
        <!-- â˜€ï¸ Sol (solo visible en modo oscuro) -->
        <svg
          id="icon-sun"
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="2"
          stroke="currentColor"
          class="w-7 h-7 text-yellow-400 hidden"
        >
          <path stroke-linecap="round" stroke-linejoin="round"
            d="M12 3v1.5m0 15V21m9-9h-1.5M4.5 12H3m15.364 
            6.364-1.06-1.06M7.757 7.757 6.697 6.697m10.607 
            0-1.06 1.06M7.757 16.243l-1.06 1.06M12 
            8.25a3.75 3.75 0 1 1 0 
            7.5 3.75 3.75 0 0 1 0-7.5z"/>
        </svg>

        <!-- ðŸŒ™ Luna (visible en modo claro) -->
        <svg
          id="icon-moon"
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="2"
          stroke="currentColor"
          class="w-7 h-7 text-indigo-300"
        >
          <path stroke-linecap="round" stroke-linejoin="round"
            d="M21 12.79A9 9 0 1 1 11.21 3a7.5 
            7.5 0 0 0 9.79 9.79z"/>
        </svg>
      </button>

      <!-- ðŸªŸ Tarjeta del login -->
      <div class="w-full max-w-md card-translucent rounded-2xl shadow-2xl p-8 transition-all duration-700 fade-in">
        <div class="text-center mb-8">
          <h1 class="text-3xl font-bold mb-2">{% trans "Bienvenido de nuevo" %} ðŸ‘‹</h1>
          <p>{% trans "Inicia sesiÃ³n para continuar" %}</p>
        </div>

        <form method="post" class="space-y-5">
          {% csrf_token %}

          <div>
            <label class="block mb-1">{% trans "Usuario" %}</label>
            <input
              type="text"
              name="username"
              required
              class="w-full px-4 py-2 rounded-lg transition-all duration-700"
            />
          </div>

          <div>
            <label class="block mb-1">{% trans "ContraseÃ±a" %}</label>
            <input
              type="password"
              name="password"
              required
              class="w-full px-4 py-2 rounded-lg transition-all duration-700"
            />
          </div>

          <button type="submit" class="btn-primary w-full py-2 px-4 rounded-lg shadow-lg">
            {% trans "Iniciar SesiÃ³n" %}
          </button>
        </form>

        <div class="mt-6 text-center">
          <a href="{% url 'password_reset' %}" class="hover:underline transition-all duration-700">
            {% trans "Â¿Olvidaste tu contraseÃ±a?" %}
          </a>
        </div>
      </div>
    </div>

    <!-- ðŸŒ“ Script cambio de tema (FUNCIONAL) -->
    <script>
      const themeToggle = document.getElementById("theme-toggle");
      const html = document.documentElement;
      const body = document.body;
      const iconSun = document.getElementById("icon-sun");
      const iconMoon = document.getElementById("icon-moon");

      // Determinar modo inicial
      const userPrefDark =
        localStorage.theme === "dark" ||
        (!("theme" in localStorage) &&
          window.matchMedia("(prefers-color-scheme: dark)").matches);

      function syncIcons(isDark) {
        if (isDark) {
          iconMoon.classList.add("hidden");
          iconSun.classList.remove("hidden");
        } else {
          iconSun.classList.add("hidden");
          iconMoon.classList.remove("hidden");
        }
      }

      // Estado inicial
      if (userPrefDark) {
        html.classList.add("dark");
        body.classList.add("dark");
        syncIcons(true);
      } else {
        syncIcons(false);
      }

      // Evento click
      themeToggle.addEventListener("click", () => {
        const isDark = html.classList.toggle("dark");
        body.classList.toggle("dark");
        localStorage.theme = isDark ? "dark" : "light";
        syncIcons(isDark);
      });
    </script>
  </body>
</html>
